import{d as f,g as Z,B as N,f as q,l as z}from"../chunks/Q0LzqFWK.js";import{b as tt}from"../chunks/BvKcVb2h.js";import{r as et}from"../chunks/BInZYZrW.js";import{t as j,a as u,b,s as A}from"../chunks/DJdsRZ5m.js";import{D as st,E as rt,F as nt,p as at,d as ot,y as it,a as ct,s as x,g as s,v as M,c as F,n as E,r as K,f as L,t as O,b as ft}from"../chunks/DXFlPq8H.js";import{p as Q,d as V,e as lt,f as G}from"../chunks/DHl97If7.js";import{e as dt,i as ut}from"../chunks/Ce0dGACN.js";import{S as mt,O as H}from"../chunks/9DlNKZc5.js";const vt=[];function $t(t,r=!1){return S(t,new Map,"",vt)}function S(t,r,m,p,i=null){if(typeof t=="object"&&t!==null){var h=r.get(t);if(h!==void 0)return h;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(st(t)){var n=Array(t.length);r.set(t,n),i!==null&&r.set(i,n);for(var l=0;l<t.length;l+=1){var _=t[l];l in t&&(n[l]=S(_,r,m,p))}return n}if(rt(t)===nt){n={},r.set(t,n),i!==null&&r.set(i,n);for(var g in t)n[g]=S(t[g],r,m,p);return n}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function")return S(t.toJSON(),r,m,p,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}async function pt(){return await f.authenticated.toCollection().first()||et(307,`${tt}/login`),{selectedEvent:await f.current_event.toCollection().first()}}const At=Object.freeze(Object.defineProperty({__proto__:null,load:pt},Symbol.toStringTag,{value:"Module"}));var _t=j("<!> <!>",1),ht=j("<div> </div> <!>",1),gt=j('<section class="center not-prose m-auto grid grid-cols-1 gap-2 md:max-w-3xl md:grid-cols-2"><!> <!> <!></section>');function Mt(t,r){var T;at(r,!0);const[m,p]=lt(),i=()=>G(s(R),"$events",m),h=()=>G(s(U),"$matchesCount",m),{title:n,actionButtons:l}=Z(),_=2025;l.set([]);async function g(){const e=await q(`/events/${_}/simple`);Array.isArray(e)&&f.events.bulkPut(e)}let c=ot(Q((T=r.data.selectedEvent)==null?void 0:T.key));async function I(){if(!s(c))return;const e=await q(`/event/${s(c)}/matches/simple`);Array.isArray(e)&&f.matches.bulkPut(e)}const R=M(()=>z(async()=>{console.time("events load");let a=(await f.events.where({year:_}).toArray()).sort((o,v)=>o.name.localeCompare(v.name));return console.timeEnd("events load"),a})),U=M(()=>z(async()=>s(c)?f.matches.where("event_key").equals(s(c)).count():0));let d=M(()=>{var e;return(e=i())==null?void 0:e.find(a=>a.key===s(c))});it(()=>{s(d)&&f.current_event.clear().then(()=>{console.log("Setting selected event",s(d)),s(d)&&f.current_event.put($t(s(d)))})}),n.set("Setup");var k=gt(),B=F(k);{var W=e=>{mt(e,{class:"w-full",anchor$class:"w-full",get value(){return s(c)},set value(a){ft(c,Q(a))},children:(a,o)=>{var v=_t(),y=L(v);H(y,{value:void 0,children:(w,$)=>{E();var P=b("Select event");u(w,P)},$$slots:{default:!0}});var C=x(y,2);dt(C,1,i,ut,(w,$)=>{H(w,{get value(){return s($).key},children:(P,yt)=>{E();var J=b();O(()=>A(J,s($).name)),u(P,J)},$$slots:{default:!0}})}),u(a,v)},$$slots:{default:!0}})};V(B,e=>{i()&&e(W)})}var D=x(B,2);N(D,{class:"w-full",variant:"raised",onclick:g,children:(e,a)=>{E();var o=b();o.nodeValue=`Download Events for ${_}`,u(e,o)},$$slots:{default:!0}});var X=x(D,2);{var Y=e=>{var a=ht(),o=L(a),v=F(o);K(o);var y=x(o,2);N(y,{class:"w-full",variant:"raised",onclick:I,children:(C,w)=>{E();var $=b();O(()=>A($,`Download Matches for ${s(d).name??""}`)),u(C,$)},$$slots:{default:!0}}),O(()=>A(v,`${h()??""} matches downloaded for event ${s(d).name??""}`)),u(e,a)};V(X,e=>{s(d)&&e(Y)})}K(k),u(t,k),ct(),p()}export{Mt as component,At as universal};
